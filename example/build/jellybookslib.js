var jellybookslib =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./main.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "../shared-models/dist/shared-test.esm.js":
/*!************************************************!*\
  !*** ../shared-models/dist/shared-test.esm.js ***!
  \************************************************/
/*! exports provided: default, Manifest, Publication */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Manifest\", function() { return Manifest; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Publication\", function() { return Publication; });\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\n\n/** Wraps a dictionary parsed from a JSON string or a JSON Object */\nvar JSONDictionary = /*#__PURE__*/function () {\n  function JSONDictionary(json) {\n    if (typeof json === 'string') {\n      this.json = JSON.parse(json);\n    } else {\n      this.json = json;\n    }\n  }\n  /** Removes the given property and returns its value */\n\n\n  var _proto = JSONDictionary.prototype;\n\n  _proto.pop = function pop(key) {\n    var value = this.json[key];\n    delete this.json[key];\n    return value;\n  }\n  /** Parses the given property AS-IS and removes it */\n  ;\n\n  _proto.parseRaw = function parseRaw(key) {\n    return this.pop(key);\n  }\n  /** Parses the given array and removes it\r\n   *  Parameter allowingSingle: If true, then allows the parsing of both a single value and an array.\r\n   */\n  ;\n\n  _proto.parseArray = function parseArray(key, allowingSingle) {\n    if (allowingSingle === void 0) {\n      allowingSingle = false;\n    }\n\n    var result = this.pop(key);\n\n    if (Array.isArray(result)) {\n      return result;\n    } else if (allowingSingle) {\n      return [result];\n    }\n\n    return [];\n  }\n  /** Parses a numeric value, but returns null if it is not */\n  ;\n\n  _proto.parseNumber = function parseNumber(key) {\n    var result = this.pop(key);\n\n    if (!isNaN(result)) {\n      return result;\n    }\n\n    return null;\n  }\n  /** Parses a numeric value, but returns null if it is not a positive number. */\n  ;\n\n  _proto.parsePositive = function parsePositive(key) {\n    var result = this.pop(key);\n\n    if (!isNaN(result) && Math.sign(result) >= 0) {\n      return result;\n    }\n\n    return null;\n  }\n  /** Parses the given key and returns a Date (or null if it’s not a string) */\n  ;\n\n  _proto.parseDate = function parseDate(key) {\n    var result = this.pop(key);\n\n    if (typeof result === 'string') {\n      return new Date(result);\n    }\n\n    return null;\n  };\n\n  return JSONDictionary;\n}();\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n\n  _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !_isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return _setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\n\n/** Represents a string media type.\r\n *  `MediaType` handles:\r\n *  - components parsing – eg. type, subtype and parameters,\r\n *  - media types comparison.\r\n */\nvar MediaType = /*#__PURE__*/function () {\n  function MediaType(mediaType) {\n    var components = mediaType.replace(/\\s/g, '').split(';');\n    var types = components[0].split('/');\n\n    if (types.length === 2) {\n      this.type = types[0].toLowerCase();\n      this.subtype = types[1].toLowerCase();\n    }\n\n    var parameters = {};\n\n    for (var i = 1; i < components.length; i++) {\n      var component = components[i].split('=');\n\n      if (component.length === 2) {\n        var key = component[0];\n        var value = component[1];\n        parameters[key] = value;\n      }\n    }\n\n    this.parameters = parameters;\n    var parametersString = '';\n\n    for (var p in parameters) {\n      var _value = parameters[p];\n      parametersString += \";\" + p + \"=\" + _value;\n    }\n\n    this.string = this.type + \"/\" + this.subtype + parametersString;\n    this.encoding = parameters['encoding'];\n  }\n  /** Structured syntax suffix, e.g. `+zip` in `application/epub+zip`.\r\n   *  Gives a hint on the underlying structure of this media type.\r\n   *  See. https://tools.ietf.org/html/rfc6838#section-4.2.8\r\n   */\n\n\n  var _proto = MediaType.prototype;\n\n  _proto.structuredSyntaxSuffix = function structuredSyntaxSuffix() {\n    var parts = this.subtype.split('+');\n    return parts.length > 1 ? \"+\" + parts[parts.length - 1] : null;\n  }\n  /** Returns whether the given `other` media type is included in this media type.\r\n   *  For example, `text/html` contains `text/html;charset=utf-8`.\r\n   *  - `other` must match the parameters in the `parameters` property, but extra parameters\r\n   *  are ignored.\r\n   *  - Order of parameters is ignored.\r\n   *  - Wildcards are supported, meaning that `image/*` contains `image/png`\r\n   */\n  ;\n\n  _proto.contains = function contains(other) {\n    if (typeof other === 'string' || other instanceof String) {\n      other = new MediaType(other);\n    }\n\n    if ((this.type === '*' || this.type === other.type) && (this.subtype === '*' || this.subtype === other.subtype)) {\n      return true;\n    }\n\n    return false;\n  }\n  /** Returns whether this media type and `other` are the same, ignoring parameters that\r\n   *  are not in both media types.\r\n   *  For example, `text/html` matches `text/html;charset=utf-8`, but `text/html;charset=ascii`\r\n   *  doesn't. This is basically like `contains`, but working in both direction.\r\n   */\n  ;\n\n  _proto.matches = function matches(other) {\n    if (typeof other === 'string' || other instanceof String) {\n      other = new MediaType(other);\n    }\n\n    return this.contains(other) || other.contains(this);\n  }\n  /** Checks the MediaType equals another one (comparing their string) */\n  ;\n\n  _proto.equals = function equals(other) {\n    return this.string === other.string;\n  }\n  /** Returns whether this media type is structured as a ZIP archive. */\n  ;\n\n  _proto.isZIP = function isZIP() {\n    return this.matches(MediaType.zip()) || this.structuredSyntaxSuffix() === '+zip';\n  }\n  /** Returns whether this media type is structured as a JSON file. */\n  ;\n\n  _proto.isJSON = function isJSON() {\n    return this.matches(MediaType.json()) || this.structuredSyntaxSuffix() === '+json';\n  }\n  /** Returns whether this media type is of an OPDS feed. */\n  ;\n\n  _proto.isOPDS = function isOPDS() {\n    return this.matches(MediaType.opds1()) || this.matches(MediaType.opds1Entry()) || this.matches(MediaType.opds2()) || this.matches(MediaType.opds2Publication()) || this.matches(MediaType.opdsAuthentication());\n  }\n  /** Returns whether this media type is of an audio clip. */\n  ;\n\n  _proto.isAudio = function isAudio() {\n    return this.type === 'audio';\n  }\n  /** Returns whether this media type is of a bitmap image, so excluding vectorial formats. */\n  ;\n\n  _proto.isBitmap = function isBitmap() {\n    return this.matches(MediaType.bmp()) || this.matches(MediaType.gif()) || this.matches(MediaType.jpeg()) || this.matches(MediaType.png()) || this.matches(MediaType.tiff()) || this.matches(MediaType.webp());\n  }\n  /** Returns whether this media type is of an HTML document. */\n  ;\n\n  _proto.isHTML = function isHTML() {\n    return this.matches(MediaType.html()) || this.matches(MediaType.xhtml());\n  }\n  /** Returns whether this media type is of a video clip. */\n  ;\n\n  _proto.isVideo = function isVideo() {\n    return this.type === 'video';\n  }\n  /** Returns whether this media type is of a Readium Web Publication Manifest. */\n  ;\n\n  _proto.isRWPM = function isRWPM() {\n    return this.matches(MediaType.readiumAudiobookManifest()) || this.matches(MediaType.divinaManifest()) || this.matches(MediaType.readiumWebPubManifest());\n  } // Known Media Types\n  ;\n\n  MediaType.aac = function aac() {\n    return new this('audio/aac');\n  };\n\n  MediaType.aiff = function aiff() {\n    return new this('audio/aiff');\n  };\n\n  MediaType.readiumAudiobook = function readiumAudiobook() {\n    return new this('application/audiobook+zip');\n  };\n\n  MediaType.readiumAudiobookManifest = function readiumAudiobookManifest() {\n    return new this('application/audiobook+json');\n  };\n\n  MediaType.avi = function avi() {\n    return new this('video/x-msvideo');\n  };\n\n  MediaType.binary = function binary() {\n    return new this('application/octet-stream');\n  };\n\n  MediaType.bmp = function bmp() {\n    return new this('image/bmp');\n  };\n\n  MediaType.cbz = function cbz() {\n    return new this('application/vnd.comicbook+zip');\n  };\n\n  MediaType.css = function css() {\n    return new this('text/css');\n  };\n\n  MediaType.divina = function divina() {\n    return new this('application/divina+zip');\n  };\n\n  MediaType.divinaManifest = function divinaManifest() {\n    return new this('application/divina+json');\n  };\n\n  MediaType.epub = function epub() {\n    return new this('application/epub+zip');\n  };\n\n  MediaType.gif = function gif() {\n    return new this('image/gif');\n  };\n\n  MediaType.gz = function gz() {\n    return new this('application/gzip');\n  };\n\n  MediaType.html = function html() {\n    return new this('text/html');\n  };\n\n  MediaType.javascript = function javascript() {\n    return new this('text/javascript');\n  };\n\n  MediaType.jpeg = function jpeg() {\n    return new this('image/jpeg');\n  };\n\n  MediaType.json = function json() {\n    return new this('application/json');\n  };\n\n  MediaType.lpf = function lpf() {\n    return new this('application/audiobook+lcp');\n  };\n\n  MediaType.mp3 = function mp3() {\n    return new this('audio/mpeg');\n  };\n\n  MediaType.mpeg = function mpeg() {\n    return new this('video/mpeg');\n  };\n\n  MediaType.ncx = function ncx() {\n    return new this('application/x-dtbncx+xml');\n  };\n\n  MediaType.ogg = function ogg() {\n    return new this('audio/ogg');\n  };\n\n  MediaType.ogv = function ogv() {\n    return new this('video/ogg');\n  };\n\n  MediaType.opds1 = function opds1() {\n    return new this('application/atom+xml;profile=opds-catalog');\n  };\n\n  MediaType.opds1Entry = function opds1Entry() {\n    return new this('application/atom+xml;type=entry;profile=opds-catalog');\n  };\n\n  MediaType.opds2 = function opds2() {\n    return new this('application/opds+json');\n  };\n\n  MediaType.opds2Publication = function opds2Publication() {\n    return new this('application/opds-publication+json');\n  };\n\n  MediaType.opdsAuthentication = function opdsAuthentication() {\n    return new this('application/opds-authentication+json');\n  };\n\n  MediaType.opus = function opus() {\n    return new this('audio/opus');\n  };\n\n  MediaType.otf = function otf() {\n    return new this('font/otf');\n  };\n\n  MediaType.pdf = function pdf() {\n    return new this('application/pdf');\n  };\n\n  MediaType.png = function png() {\n    return new this('image/png');\n  };\n\n  MediaType.smil = function smil() {\n    return new this('application/smil+xml');\n  };\n\n  MediaType.svg = function svg() {\n    return new this('image/svg+xml');\n  };\n\n  MediaType.text = function text() {\n    return new this('text/plain');\n  };\n\n  MediaType.tiff = function tiff() {\n    return new this('image/tiff');\n  };\n\n  MediaType.ttf = function ttf() {\n    return new this('font/ttf');\n  };\n\n  MediaType.wav = function wav() {\n    return new this('audio/wav');\n  };\n\n  MediaType.webmAudio = function webmAudio() {\n    return new this('audio/webm');\n  };\n\n  MediaType.webmVideo = function webmVideo() {\n    return new this('video/webm');\n  };\n\n  MediaType.webp = function webp() {\n    return new this('image/webp');\n  };\n\n  MediaType.readiumWebPub = function readiumWebPub() {\n    return new this('application/webpub+zip');\n  };\n\n  MediaType.readiumWebPubManifest = function readiumWebPubManifest() {\n    return new this('application/webpub+json');\n  };\n\n  MediaType.w3cWPUBManifest = function w3cWPUBManifest() {\n    return new this('application/x.readium.w3c.wpub+json');\n  };\n\n  MediaType.woff = function woff() {\n    return new this('font/woff');\n  };\n\n  MediaType.woff2 = function woff2() {\n    return new this('font/woff2');\n  };\n\n  MediaType.xhtml = function xhtml() {\n    return new this('application/xhtml+xml');\n  };\n\n  MediaType.xml = function xml() {\n    return new this('application/xml');\n  };\n\n  MediaType.zab = function zab() {\n    return new this('application/x.readium.zab+zip');\n  };\n\n  MediaType.zip = function zip() {\n    return new this('application/zip');\n  };\n\n  return MediaType;\n}();\n\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\nvar Properties = /*#__PURE__*/function () {\n  function Properties(json) {\n    if (typeof json === 'string') {\n      this.otherProperties = JSON.parse(json);\n    } else {\n      this.otherProperties = json;\n    }\n  }\n\n  var _proto = Properties.prototype;\n\n  _proto.adding = function adding(properties) {\n    var copy = JSON.parse(JSON.stringify(this.otherProperties));\n\n    for (var property in properties) {\n      copy[property] = properties[property];\n    }\n\n    return new Properties(copy);\n  };\n\n  return Properties;\n}();\n\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\n\n/** A lightweight implementation of URI Template (RFC 6570).\r\n *  Only handles simple cases, fitting Readium's use cases.\r\n *  See https://tools.ietf.org/html/rfc6570\r\n *\r\n *  TODO: extensive testing\r\n */\nvar URITemplate = /*#__PURE__*/function () {\n  function URITemplate(uri) {\n    this.uri = uri;\n    /** List of URI template parameter keys. */\n\n    this.parameters = this.getParameters(uri);\n  }\n\n  var _proto = URITemplate.prototype;\n\n  _proto.getParameters = function getParameters(uri) {\n    var regex = /\\{\\??([^}]+)\\}/g;\n    var match = uri.match(regex);\n\n    if (match) {\n      return new Set(match.join(',').replace(regex, '$1').split(',').map(function (m) {\n        return m.trim();\n      }));\n    }\n\n    return new Set();\n  }\n  /** Expands the URI by replacing the template variables by the given parameters.\r\n   *  Any extra parameter is appended as query parameters.\r\n   *  See RFC 6570 on URI template: https://tools.ietf.org/html/rfc6570\r\n   */\n  ;\n\n  _proto.expand = function expand(parameters) {\n    var expandSimpleString = function expandSimpleString(string) {\n      return string.split(',').map(function (parameter) {\n        return parameters[parameter] || '';\n      }).join(',');\n    };\n\n    var expandFormStyle = function expandFormStyle(string) {\n      return '?' + string.split(',').map(function (expression) {\n        var parameter = expression.split('=')[0];\n\n        if (parameters[parameter]) {\n          return parameter + \"=\" + parameters[parameter];\n        } else {\n          return '';\n        }\n      }).join('&');\n    };\n\n    return this.uri.replace(/\\{(\\??)([^}]+)\\}/g, function () {\n      return !(arguments.length <= 1 ? undefined : arguments[1]) ? expandSimpleString(arguments.length <= 2 ? undefined : arguments[2]) : expandFormStyle(arguments.length <= 2 ? undefined : arguments[2]);\n    });\n  };\n\n  return URITemplate;\n}();\n\n/** Link Object for the Readium Web Publication Manifest.\r\n *  https://readium.org/webpub-manifest/schema/link.schema.json\r\n */\n\nvar Link = /*#__PURE__*/function () {\n  function Link(link) {\n    this.href = link.href;\n    this.templated = link.templated;\n    this.type = link.type;\n    this.title = link.title;\n    this.rels = new Set(link.rel);\n    this.properties = new Properties(link.properties);\n    this.height = link.height;\n    this.width = link.width;\n    this.duration = link.duration;\n    this.bitrate = link.bitrate;\n    this.languages = link.language;\n    this.alternates = link.alternate ? new Links(link.alternate) : new Links([]);\n    this.children = link.children ? new Links(link.children) : new Links([]);\n    this.mediaType = link.type ? new MediaType(link.type) : undefined;\n    this.templateParameters = this.getTemplateParameters();\n  }\n  /** Computes an absolute URL to the link, relative to the given `baseURL`.\r\n   *  If the link's `href` is already absolute, the `baseURL` is ignored.\r\n   */\n\n\n  var _proto = Link.prototype;\n\n  _proto.toAbsoluteHREF = function toAbsoluteHREF(baseUrl) {\n    return new URL(this.href, baseUrl).href;\n  }\n  /** List of URI template parameter keys, if the `Link` is templated. */\n  ;\n\n  _proto.getTemplateParameters = function getTemplateParameters() {\n    if (!this.templated) {\n      return new Set();\n    } else {\n      return new URITemplate(this.href).parameters;\n    }\n  }\n  /** Expands the `Link`'s HREF by replacing URI template variables by the given parameters.\r\n   *  See RFC 6570 on URI template: https://tools.ietf.org/html/rfc6570\r\n   */\n  ;\n\n  _proto.expandTemplate = function expandTemplate(parameters) {\n    // Probably make copy instead of a new one\n    return new Link({\n      href: new URITemplate(this.href).expand(parameters),\n      templated: false\n    });\n  };\n\n  return Link;\n}();\n/** Parses multiple JSON links into an array of Link. */\n\nvar Links = /*#__PURE__*/function (_Array) {\n  _inheritsLoose(Links, _Array);\n\n  function Links(items) {\n    var _this;\n\n    if (items instanceof Array) {\n      _this = _Array.call.apply(_Array, [this].concat(items.map(function (item) {\n        return new Link(item);\n      }))) || this;\n    } else {\n      _this = _Array.call(this, items) || this;\n    }\n\n    Object.setPrototypeOf(_assertThisInitialized(_this), (this instanceof Links ? this.constructor : void 0).prototype);\n    return _assertThisInitialized(_this);\n  }\n  /** Finds the first link with the given relation. */\n\n\n  var _proto2 = Links.prototype;\n\n  _proto2.findWithRel = function findWithRel(rel) {\n    var predicate = function predicate(el) {\n      return el.rels.has(rel);\n    };\n\n    return this.find(predicate) || null;\n  }\n  /** Finds all the links with the given relation. */\n  ;\n\n  _proto2.filterByRel = function filterByRel(rel) {\n    var predicate = function predicate(el) {\n      return el.rels.has(rel);\n    };\n\n    return this.filter(predicate);\n  }\n  /** Finds the first link matching the given HREF. */\n  ;\n\n  _proto2.findWithHref = function findWithHref(href) {\n    var predicate = function predicate(el) {\n      return el.href === href;\n    };\n\n    return this.find(predicate) || null;\n  }\n  /** Finds the index of the first link matching the given HREF. */\n  ;\n\n  _proto2.findIndexWithHref = function findIndexWithHref(href) {\n    var predicate = function predicate(el) {\n      return el.href === href;\n    };\n\n    return this.findIndex(predicate);\n  }\n  /** Finds the first link matching the given media type. */\n  ;\n\n  _proto2.findWithMediaType = function findWithMediaType(mediaType) {\n    var predicate = function predicate(el) {\n      return el.mediaType ? el.mediaType.matches(mediaType) : false;\n    };\n\n    return this.find(predicate) || null;\n  }\n  /** Finds all the links matching the given media type. */\n  ;\n\n  _proto2.filterByMediaType = function filterByMediaType(mediaType) {\n    var predicate = function predicate(el) {\n      return el.mediaType ? el.mediaType.matches(mediaType) : false;\n    };\n\n    return this.filter(predicate);\n  }\n  /** Finds all the links matching any of the given media types. */\n  ;\n\n  _proto2.filterByMediaTypes = function filterByMediaTypes(mediaTypes) {\n    var predicate = function predicate(el) {\n      for (var _iterator = _createForOfIteratorHelperLoose(mediaTypes), _step; !(_step = _iterator()).done;) {\n        var mediaType = _step.value;\n        return el.mediaType ? el.mediaType.matches(mediaType) : false;\n      }\n\n      return false;\n    };\n\n    return this.filter(predicate);\n  }\n  /** Returns whether all the resources in the collection are audio clips. */\n  ;\n\n  _proto2.everyIsAudio = function everyIsAudio() {\n    var predicate = function predicate(el) {\n      return el.mediaType ? el.mediaType.isAudio() : false;\n    };\n\n    return this.every(predicate);\n  }\n  /** Returns whether all the resources in the collection are bitmaps. */\n  ;\n\n  _proto2.everyIsBitmap = function everyIsBitmap() {\n    var predicate = function predicate(el) {\n      return el.mediaType ? el.mediaType.isBitmap() : false;\n    };\n\n    return this.every(predicate);\n  }\n  /** Returns whether all the resources in the collection are HTML documents. */\n  ;\n\n  _proto2.everyIsHTML = function everyIsHTML() {\n    var predicate = function predicate(el) {\n      return el.mediaType ? el.mediaType.isHTML() : false;\n    };\n\n    return this.every(predicate);\n  }\n  /** Returns whether all the resources in the collection are video clips. */\n  ;\n\n  _proto2.everyIsVideo = function everyIsVideo() {\n    var predicate = function predicate(el) {\n      return el.mediaType ? el.mediaType.isVideo() : false;\n    };\n\n    return this.every(predicate);\n  }\n  /** Returns whether all the resources in the collection are matching any of the given media types. */\n  ;\n\n  _proto2.everyMatchesMediaType = function everyMatchesMediaType(mediaTypes) {\n    if (Array.isArray(mediaTypes)) {\n      return this.every(function (el) {\n        for (var _iterator2 = _createForOfIteratorHelperLoose(mediaTypes), _step2; !(_step2 = _iterator2()).done;) {\n          var mediaType = _step2.value;\n          return el.mediaType ? el.mediaType.matches(mediaType) : false;\n        }\n\n        return false;\n      });\n    } else {\n      return this.every(function (el) {\n        return el.mediaType ? el.mediaType.matches(mediaTypes) : false;\n      });\n    }\n  };\n\n  return Links;\n}( /*#__PURE__*/_wrapNativeSuper(Array));\n\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\n/** Core Collection Model\r\n *  https://readium.org/webpub-manifest/schema/subcollection.schema.json\r\n *  Can be used as extension point in the Readium Web Publication Manifest.\r\n */\n\nvar CoreCollection = /*#__PURE__*/function () {\n  function CoreCollection(json) {\n    if (Array.isArray(json)) {\n      this.links = new Links(json);\n    } else {\n      var jsonCollection = new JSONDictionary(json);\n      this.metadata = jsonCollection.parseRaw('metadata');\n      this.links = new Links(jsonCollection.parseArray('links'));\n      this.subcollections = CoreCollection.makeCollections(jsonCollection);\n    }\n  }\n\n  CoreCollection.makeCollections = function makeCollections(json) {\n    var collection = {};\n\n    for (var key in json) {\n      collection[key] = new this(json[key]);\n    }\n\n    return collection;\n  };\n\n  return CoreCollection;\n}();\n\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\nvar ReadingProgression;\n\n(function (ReadingProgression) {\n  ReadingProgression[\"auto\"] = \"auto\";\n  ReadingProgression[\"btt\"] = \"btt\";\n  ReadingProgression[\"ltr\"] = \"ltr\";\n  ReadingProgression[\"rtl\"] = \"rtl\";\n  ReadingProgression[\"ttb\"] = \"ttb\";\n})(ReadingProgression || (ReadingProgression = {})); // Note: Babel doesn’t really like that at all so disabling for the time being\n // }\n\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\nvar Metadata = /*#__PURE__*/function () {\n  function Metadata(metadata) {\n    var json = new JSONDictionary(metadata);\n    this.title = json.parseRaw('title');\n    this['@type'] = json.parseRaw('@type');\n    this.identifier = json.parseRaw('identifier');\n    this.subtitle = json.parseRaw('subtitle');\n    this.artists = json.parseArray('artist');\n    this.authors = json.parseArray('author');\n    this.colorists = json.parseArray('colorist');\n    this.contributors = json.parseArray('contributor');\n    this.editors = json.parseArray('editor');\n    this.illustrators = json.parseArray('illustrator');\n    this.inkers = json.parseArray('inker');\n    this.letterers = json.parseArray('letterer');\n    this.narrators = json.parseArray('narrator');\n    this.pencilers = json.parseArray('penciler');\n    this.translators = json.parseArray('translator');\n    this.languages = json.parseArray('language');\n    this.description = json.parseRaw('description');\n    this.publishers = json.parseArray('publisher');\n    this.imprints = json.parseArray('imprint');\n    this.published = json.parseDate('published');\n    this.modified = json.parseDate('modified');\n    this.subjects = json.parseArray('subject');\n    var belongsTo = json.parseRaw('belongsTo');\n    this.belongsToCollection = belongsTo ? belongsTo['collection'] : [];\n    this.belongsToSeries = belongsTo ? belongsTo['series'] : [];\n    this.readingProgression = json.parseRaw('readingProgression') || ReadingProgression.auto;\n    this.duration = json.parsePositive('duration');\n    this.numberOfPages = json.parsePositive('numberOfPages');\n    this.otherMetadata = json.json;\n  }\n  /** Computes a `ReadingProgression` when the value of `readingProgression` is set to `auto`,\r\n   *  using the publication language.\r\n   */\n\n\n  var _proto = Metadata.prototype;\n\n  _proto.effectiveReadingProgression = function effectiveReadingProgression() {\n    if (this.readingProgression && this.readingProgression !== ReadingProgression.auto) {\n      return this.readingProgression;\n    }\n\n    if (this.languages.length > 0) {\n      var primaryLang = this.languages[0];\n      var lang = primaryLang.includes('zh') ? primaryLang : primaryLang.split('-')[0];\n\n      if (Metadata.RTLLanguages.includes(lang)) {\n        return ReadingProgression.rtl;\n      }\n    }\n\n    return ReadingProgression.ltr;\n  };\n\n  _proto.getOtherMetadata = function getOtherMetadata() {\n    return this.otherMetadata;\n  };\n\n  return Metadata;\n}();\n/* public otherMetadata */\n\nMetadata.RTLLanguages = ['ar', 'fa', 'he', 'zh-Hant', 'zh-TW'];\n\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\n/** Holds the metadata of a Readium publication, as described in\r\n *  the Readium Web Publication Manifest.\r\n *  See. https://readium.org/webpub-manifest/\r\n */\n\nvar Manifest = /*#__PURE__*/function () {\n  function Manifest(manifestJSON) {\n    var json = new JSONDictionary(manifestJSON);\n    this.context = json.parseArray('@context');\n    this.metadata = new Metadata(json.parseRaw('metadata'));\n    this.links = new Links(json.parseArray('links'));\n    this.readingOrder = new Links(json.parseArray('readingOrder'));\n    this.resources = new Links(json.parseArray('resources'));\n    this.tableOfContents = new Links(json.parseArray('toc'));\n    this.subcollections = CoreCollection.makeCollections(json.json);\n  }\n  /** Finds the first link with the given relation in the manifest's links. */\n\n\n  var _proto = Manifest.prototype;\n\n  _proto.linkWithRel = function linkWithRel(rel) {\n    var links = [this.readingOrder, this.resources, this.links];\n    var result = null;\n\n    for (var _i = 0, _links = links; _i < _links.length; _i++) {\n      var collection = _links[_i];\n      result = collection.findWithRel(rel);\n\n      if (result !== null) {\n        return result;\n      }\n    }\n\n    return result;\n  }\n  /** Finds all the links with the given relation in the manifest's links. */\n  ;\n\n  _proto.linksWithRel = function linksWithRel(rel) {\n    var result = [];\n    result.push(this.readingOrder.filterByRel(rel), this.resources.filterByRel(rel), this.links.filterByRel(rel));\n    return result.reduce(function (acc, val) {\n      return acc.concat(val);\n    }, []);\n  };\n\n  return Manifest;\n}();\n\n/* Copyright 2020 Readium Foundation. All rights reserved.\r\n * Use of this source code is governed by a BSD-style license,\r\n * available in the LICENSE file present in the Github repository of the project.\r\n */\n\n/** Shared model for a Readium Publication. */\nvar Publication = /*#__PURE__*/function () {\n  function Publication(manifest) {\n    this.manifest = manifest;\n    this.metadata = this.manifest.metadata;\n    this.links = this.manifest.links;\n    /** Identifies a list of resources in reading order for the publication. */\n\n    this.readingOrder = this.manifest.readingOrder;\n    /** Identifies resources that are necessary for rendering the publication. */\n\n    this.resources = this.manifest.resources;\n    /** Identifies the collection that contains a table of contents. */\n\n    this.tableOfContents = this.manifest.tableOfContents;\n    this.subcollections = this.manifest.subcollections;\n  }\n  /** The URL where this publication is served, computed from the `Link` with `self` relation.\r\n   *  e.g. https://provider.com/pub1293/manifest.json gives https://provider.com/pub1293/\r\n   */\n\n\n  var _proto = Publication.prototype;\n\n  _proto.baseURL = function baseURL() {\n    var selfLink = this.manifest.links.find(function (el) {\n      return el.rels.has('self');\n    });\n\n    if (selfLink) {\n      return selfLink.href;\n    } else {\n      return null;\n    }\n  }\n  /** Finds the first Link having the given `href` in the publication's links. */\n  ;\n\n  _proto.linkWithHref = function linkWithHref(href) {\n    var find = function find(links) {\n      var result = null;\n\n      for (var _iterator = _createForOfIteratorHelperLoose(links), _step; !(_step = _iterator()).done;) {\n        var collection = _step.value;\n        result = collection.findWithHref(href);\n\n        if (result !== null) {\n          return result;\n        }\n      }\n\n      var children = links.flatMap(function (item) {\n        var arr = [];\n\n        for (var _iterator2 = _createForOfIteratorHelperLoose(item), _step2; !(_step2 = _iterator2()).done;) {\n          var _link = _step2.value;\n\n          if (_link.alternates) {\n            arr.push(_link.alternates);\n          }\n\n          if (_link.children) {\n            arr.push(_link.children);\n          }\n        }\n\n        return arr;\n      });\n      find(children);\n      return result;\n    };\n\n    var links = [this.manifest.readingOrder, this.manifest.resources, this.manifest.links];\n    var link = find(links);\n\n    if (link !== null) {\n      return link;\n    }\n\n    var shortHref = href.split(/[#\\?]/)[0];\n    this.linkWithHref(shortHref);\n    return link;\n  }\n  /** Finds the first link with the given relation in the publication's links. */\n  ;\n\n  _proto.linkWithRel = function linkWithRel(rel) {\n    return this.manifest.linkWithRel(rel);\n  }\n  /** Finds all the links with the given relation in the publication's links. */\n  ;\n\n  _proto.linksWithRel = function linksWithRel(rel) {\n    return this.manifest.linksWithRel(rel);\n  };\n\n  return Publication;\n}();\n\nfunction api() {\n  var createManifest = function createManifest(json) {\n    return new Manifest(json);\n  };\n\n  var createPublication = function createPublication(manifest) {\n    return new Publication(manifest);\n  }; //for test\n\n\n  var getData = function getData(x) {\n    return \"hi - \" + x;\n  };\n\n  var _api = {\n    createManifest: createManifest,\n    createPublication: createPublication,\n    getData: getData\n  };\n  return _api;\n}\n//   if ('development' === process.env.NODE_ENV) {\n//     console.log('boop');\n//   }\n//   return a + b;\n// };\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (api);\n\n//# sourceMappingURL=shared-test.esm.js.map\n\n\n//# sourceURL=webpack://jellybookslib/../shared-models/dist/shared-test.esm.js?");

/***/ }),

/***/ "./main.ts":
/*!*****************!*\
  !*** ./main.ts ***!
  \*****************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar shared_test_1 = __webpack_require__(/*! @jellybooks/shared-test */ \"../shared-models/dist/shared-test.esm.js\");\nvar textElement = document.getElementById(\"text\");\nvar lib = shared_test_1.default();\n//textElement.innerText = lib.getData('test');\nfetch(\"manifest.json\")\n    .then(function (response) { return response.json(); })\n    .then(function (json) {\n    var manifest = lib.createManifest(json);\n    var pubObj = lib.createPublication(manifest);\n    textElement.innerText = JSON.stringify(pubObj, null, 2);\n});\n\n\n//# sourceURL=webpack://jellybookslib/./main.ts?");

/***/ })

/******/ });